#+TITLE:A SIMULATED ANNEALING APPROACH TO THE BATTERY ELECTRIC BUS CHARGING PROBLEM
#+author: Alexander Brown
#+date: \today
#+startup: beamer
#+LaTeX_CLASS: beamer
#+LaTeX_CLASS_OPTIONS: [bigger]
#+OPTIONS: H:2

#+COLUMNS: %40ITEM %10BEAMER_env(Env) %9BEAMER_envargs(Env Args) %4BEAMER_col(Col) %10BEAMER_extra(Extra)

#+BEAMER_HEADER: \AtBeginSection{\frame{\sectionpage}}
#+LaTeX_CLASS_options: [aspectratio=169]

#+latex_header:\logo{\includegraphics[height=0.5cm]{img/u-state-black.png}}

#+latex_header: \usepackage[ruled]{algorithm2e}             % Algorithms
#+latex_header: \usepackage{tikz}                           % Draw stuff
#+latex_header: \usetikzlibrary{arrows.meta}                % Arrows for tikz
#+latex_header: \usepackage{subcaption}                     % Subfigures

#+latex_header: \institute[USU] % (optional)
#+latex_header: {
#+latex_header:   College of Engineering\\
#+latex_header:   Utah State University
#+latex_header: }

#+latex_header: \addtobeamertemplate{navigation symbols}{}{%
#+latex_header:     \usebeamerfont{footline}%
#+latex_header:     \usebeamercolor[fg]{footline}%
#+latex_header:     \hspace{1em}%
#+latex_header:     \insertframenumber/\inserttotalframenumber
#+latex_header: }

# =========================================================================================================================
# Custom commands
#+latex_header: \newcommand\mycommfont[1]{\footnotesize\ttfamily\textcolor{gray}{#1}}

#+latex_header: \newcommand{\T}{\mathcal{T}}                % To make it clear the difference
#+latex_header: \newcommand{\Tau}{T}                        % between Tau and T
#+latex_header: \newcommand{\AC}{AC(u, d, v, \eta)}         % Set the parameters for AC once
#+latex_header: \newcommand{\UC}{UC(u, d, v)}               % Set the parameters for UC once
#+latex_header: \newcommand{\ACi}{AC(u_i, d_i, q_i, \eta_i)}% Set the parameters for AC once
#+latex_header: \newcommand{\UCi}{UC(u_i, d_i, q_i)}        % Set the parameters for UC once
#+latex_header: \newcommand{\Not}{\textbf{not }}            % Custom `not' operator
#+latex_header: \newcommand{\visit}{(i, b, a, e, u, d, q, \eta, \xi)}
#+latex_haeder:                                             % Single visit tuple
#+latex_header: \newcommand{\I}{\mathbb{I}}                 % Set of visit tuples
#+latex_header: \newcommand{\C}{\mathbb{C}}                 % Charger availability information
#+latex_header: \newcommand{\U}{\mathcal{U}}                % Uniform distribution
#+latex_header: \newcommand{\W}{\mathcal{W}}                % Weighted distribution
#+latex_header: \newcommand{\Sol}{\mathbb{S}}               % A shorthand for visit tuple
#+latex_header: \newcommand{\M}{\mathbb{M}}                 % A shorthand for the metadata
#+latex_header: \newcommand{\Hd}{\mathbb{H}}                % Set of discrete times
#+latex_header: \newcommand{\Nu}{\mathcal{V}}               % Draw a nice Nu

#+latex_header: \newcommand{\Iset}{I}                       % Set of visits 1-I
#+latex_header: \newcommand{\Isetinit}{I_0}                 % Set of visits inital visits
#+latex_header: \newcommand{\Isetfinal}{I_f}                % Set of visits final visits
#+latex_header: \newcommand{\Bset}{B}                       % Set of visits 1-B
#+latex_header: \newcommand{\Qset}{Q}                       % Set of visits 1-Q
#+latex_header: \newcommand{\Jset}{J}                       % Set of visits 1-J
#+latex_header: \newcommand{\Jsetq}{\mathbb{J}}             % Set of visits 1-J for queue active times
#+latex_header: \newcommand{\Hset}{H}                       % Set of visits 1-H

# https://orgmode.org/worg/exporters/beamer/tutorial.html

* Introduction
** Problem Description
#+ATTR_LATEX: :width 0.7\textwidth
[[./img/visit.pdf]]

** Problem Description :noexport:
- Introduce the problem
- What are we trying to solve
- Mini literature review

** Problem Description
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- Fleet size of $n_A$ buses
- $n_V$ visits[fn:1] divided between the $n_A$ buses
- Each bus in initialized with a charge of $\alpha_b \kappa_i$

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- Each route has a paired route with discharge of $\Delta_i$
- The charge is not allowed to go below $\nu_b \kappa_i$ during operational hours
- Each bus is required to finish the day with a minimum charge of $\beta_b \kappa_i$[fn:2]

** The Berth Allocation Problem[fn:3]
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.9\textwidth]{img/berthing-sky-picture}
\end{figure}

** The Berth Allocation Problem
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- Vessels move down toward the quay
- Recieve service
- Exit to the right

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\begin{figure}[htpb]
\centering
    \includegraphics{img/bap}
    \label{subfig:bapexample}
\end{figure}

** The Berth Allocation Problem
*** Left
:PROPERTIES:
:BEAMER_col: 0.7
:END:
- A variant of the rectangle packing problem
- Solves the problem of optimally assigning incoming vessels to be serviced
  - $\mathbb{O}$: Spatiotemporal allocations for vessels
  - $O$: Time horizon and berthing space

*** Right
:PROPERTIES:
:BEAMER_col: 0.3
:END:
\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/spatiotemporal-packing}
\end{figure}

** The Position Allocation Problem
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- Service flow is left to right
- Single charger type
- All arrivals are considered unique
- Service times are assumed to be known

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\begin{figure}[htpb]
\centering
    \includegraphics{img/pap}
    \label{subfig:papexample}
\end{figure}

* The Position Allocation Problem Approach With Linear Battery Dynamic
** Requirements For BEB Implementation
- Charges must be able to be tracked
- Service time is unknown
- Accommodate chargers of different speeds
- Minimize charger count
- Minimize consumption cost
- Encourage slow charger use for battery health

** Objective Function
\begin{equation*}
\label{eq:objective}
	\min \sum_{i=1}^{n_V} \sum_{q=1}^{n_Q} \Big( w_{iq} m_q + g_{iq} \epsilon_q \Big)
\end{equation*}

- $w_{iq} m_q$: Assignment cost
- $g_{iq} \epsilon_q$: Consumption cost

** Constraints
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\begin{equation*}
    u_j - u_i - s_i - (\sigma_{ij} - 1)T \geq 0
\end{equation*}
\begin{equation*}
    v_j - v_i - (\psi_{ij} - 1)n_Q \geq 1
\end{equation*}
\begin{equation*}
    \sigma_{ij} + \sigma_{ji} \leq 1
\end{equation*}
\begin{equation*}
    \psi_{ij} + \psi_{ji} \leq 1
\end{equation*}
\begin{equation*}
    \sigma_{ij} + \sigma_{ji} + \psi_{ij} + \psi_{ji} \geq 1
\end{equation*}
\begin{equation*}
    \sum_{q=1}^{n_Q} w_{iq} = 1
\end{equation*}
\begin{equation*}
    v_i = \sum_{q=1}^{n_Q} qw_{iq}
\end{equation*}

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\begin{equation*}
    s_i + u_i = d_i
\end{equation*}
\begin{equation*}
    a_i \leq u_i \leq (T - s_i)
\end{equation*}
\begin{equation*}
    d_i \leq \tau_i
\end{equation*}
\begin{equation*}
    \eta_i + \sum_{q=1}^{n_Q} g_{iq} r_q - \Delta_i = \eta_{\gamma_i}
\end{equation*}
\begin{equation*}
    \eta_i + \sum_{q=1}^{n_Q} g_{iq} r_q - \Delta_i \geq \nu_{\Gamma_i} \kappa_{\Gamma_i}
\end{equation*}
\begin{equation*}
    \eta_i + \sum_{q=1}^{n_Q} g_{iq} r_q \leq \kappa_{\Gamma_i}
\end{equation*}

** Packing Constraints :noexport:
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:

- Used to ensure that individual rectangles do not overlap
- $\sigma_{ij}$ establishes temporal ordering when active
- $\psi_{ij}$ establishes spacial ordering when active

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:

\begin{equation*}
    u_j - u_i - s_i - (\sigma_{ij} - 1)T \geq 0
\end{equation*}
\begin{equation*}
    v_j - v_i - (\psi_{ij} - 1)n_Q \geq 1
\end{equation*}
\begin{equation*}
    \sigma_{ij} + \sigma_{ji} \leq 1
\end{equation*}
\begin{equation*}
    \psi_{ij} + \psi_{ji} \leq 1
\end{equation*}
\begin{equation*}
    \sigma_{ij} + \sigma_{ji} + \psi_{ij} + \psi_{ji} \geq 1
\end{equation*}

** Packing Constraints :noexport:
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:

- Used to ensure that individual rectangles do not overlap
- $\sigma_{ij}$ establishes temporal ordering when active
- $\psi_{ij}$ establishes spacial ordering when active

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
#+begin_src latex
      \begin{figure}
      \centering
      \scalebox{0.33}{
        \centering
          \begin{tikzpicture}
            % Variables
            \def \arrx   {2.0}
            \def \initx  {3.5}
            \def \endx   {8.5}
            \def \depx   {10.0}
            \def \yshift {5}

            % Axis
            \draw [thick,<->] (0,15) node[above]{Queues} -- (0,0) -- (15,0) node[right]{Time};

            % Rectangles
            \node[rectangle, draw, fill=gray, minimum width=4cm, minimum height = 3cm] at (3,12) {A};
            \node[rectangle, draw, fill=gray, minimum width=3cm, minimum height = 3cm] at (9,12) {B};
            \node[rectangle, draw, fill=gray, minimum width=5cm, minimum height = 3cm] at (6,7) {D};
            \node[rectangle, draw, fill=gray, minimum width=6cm, minimum height = 3cm] at (12,2) {C};

            % X-axis labels
            \node [below,align=center] at (\arrx,0) {\scriptsize Arrival     \\ \scriptsize Time \\ $a_D$};
            \node [below, align=center] at (\initx,0) {\scriptsize Charge    \\ \scriptsize Initiation  \\ $u_D$};
            \node [below, align=center] at (\endx,0) {\scriptsize Charge     \\ \scriptsize End \\ $d_D$};
            \node [below, align=center] at (\depx,0) {\scriptsize Departure  \\ \scriptsize Time \\ $e_D$};

            % Y-axis labels
            \node[rotate=90] at (-1, 2.25) {Queue 1};
            \node[rotate=90] at (-1, 7.25) {Queue 2};
            \node[rotate=90] at (-1, 12.25) {Queue 3};

            % Vertical lines
            \draw[dashed] (\arrx,\yshift)--(\arrx,0);
            \draw[dashed] (\initx,\yshift)--(\initx,0);
            \draw[dashed] (\endx,\yshift)--(\endx,0);
            \draw[dashed] (\depx,\yshift)--(\depx,0);

            % Horizontal lines
            \draw[dotted] (0, 4.5) -- (15, 4.5);
            \draw[dotted] (0, 9.5) -- (15, 9.5);

          \end{tikzpicture}
        }
        \label{fig:spacial-and-temporal-constr}
  \end{figure}
#+end_src
** Packing Constraints :noexport:
** Linear Battery Dynamic Constraints :noexport:
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
 - Calculates the charge for the next visit
 - Ensures the current charge is above the minimum charge threshold
 - Ensures the current charge is below the battery capacity

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\begin{equation*}
    \eta_i + \sum_{q=1}^{n_Q} g_{iq} r_q - \Delta_i = \eta_{\gamma_i}
\end{equation*}
\begin{equation*}
    \eta_i + \sum_{q=1}^{n_Q} g_{iq} r_q - \Delta_i \geq \nu_{\Gamma_i} \kappa_{\Gamma_i}
\end{equation*}
\begin{equation*}
    \eta_i + \sum_{q=1}^{n_Q} g_{iq} r_q \leq \kappa_{\Gamma_i}
\end{equation*}

** Bilinear Linearization Constraints :noexport:
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:

- Linearization of bilinear terms

#+begin_src latex
\begin{equation*}
    \label{eq:giq_cases}
    g_{iq} =
    \begin{cases}
        s_i & w_{iq} = 1 \\
        0 & w_{iq} = 0
    \end{cases}.
\end{equation*}
#+end_src

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\begin{equation*}
    s_i - (1 - w_{iq})M \leq g_{iq}
\end{equation*}
\begin{equation*}
    s_i \geq g_{iq}
\end{equation*}
\begin{equation*}
    Mw_{iq} \geq g_{iq}
\end{equation*}
\begin{equation*}
    0 \leq g_{iq}
\end{equation*}

** Charging Queue Constraints :noexport:
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:

- Ensure only one queue is selected per visit
- Convert vector representation of queue selection to an integer

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\begin{equation*}
    \sum_{q=1}^{n_Q} w_{iq} = 1
\end{equation*}
\begin{equation*}
    v_i = \sum_{q=1}^{n_Q} qw_{iq}
\end{equation*}

** Results
- Executed for 7200 seconds (2 hours)
- $T = 24$
- $n_V = 338$
- $n_A = 35$
-  $\alpha_i = 90\%$;  $\nu_i = 20\%$;  $\beta_i = 70\%$
- $\forall q \in \{n_B + 1, n_B + 2,..., n_B + n_C \}; m_q = 1000q$

** Schedules
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/schedule-milp-pap}
\end{figure}

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/schedule-qin}
\end{figure}

** Fast Charger Count :noexport:
\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/charger-count-fast-milp-pap}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/charger-count-slow-milp-pap}
\end{figure}

** Power And Energy Use
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/energy-milp-pap}
\end{figure}

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/power-milp-pap}
\end{figure}

* The Simulated Annealing Approach With Linear Battery Dynamics
** Simulated Annealing
- Named after its analogized process where a crystalline solid is heated then allowed to cool at a slow rate until it achieves its most regular possible crystal lattice configuration
- The algorithm is often applied to problems that contain many local solutions as it employs a stochastic approach that explores the solution space for an approximate global optimum.
- Within the SA process there are three key components
  - Cooling Schedule
  - Acceptance Criteria
  - Generation Mechanisms
** Cooling Schedule
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- The cooling equation models the rate at which the temperature decreases over time in the SA process.
- The temperature is high, SA encourages exploration. As the temperature decreases, exploitation is encouraged.

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:

#+begin_src latex
  \begin{figure}[t!]
    \centering \includegraphics[width=0.9\textwidth]{img/geometric.png}
    \label{fig:geometric}
  \end{figure}

  \begin{equation*}
  t_m = \beta t_{m-1}
  \end{equation*}
#+end_src

** Acceptance Criteria
#+name: eq:candaccept
\begin{equation}
f(\mathbb{I},\bar{\mathbb{I}},t_m) =
\begin{cases}
  1                   & \Delta E > 0 \\
  e^{- \frac{\Delta E}{t_m}} & \text{otherwise}
\end{cases}
\end{equation}

** Generation Mechanisms - Primitive Functions
- New Visit: Move a bus from a wait queue to charge queue
- Slide Visit: Change the charge duration of a visit
- New Charger: Move a visit to a new charger
- Wait: Move a visit to its idle queue
- New Window: Execute Wait then New Visit primitives

** Generation Mechanisms - Wrapper Functions
- Charge Schedule Generation: Iterate through each visit and execute New Visit
- Perturb Schedule: Randomly execute one of the primitives with a weighted distribution

** Objective Function
\begin{equation*}
  J(\mathbb{I}) = z_d p_d + \sum_{i=1}^{n_V} \Big[ \epsilon_{q_i}r_{q_i} + z_p \phi_i(\eta_i - \nu_{b_i} \kappa_{b_i}) + z_c r_{q_i} s_i \Big]
\end{equation*}

*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- Demand cost
  - $p_{T_p}[h] = \frac{1}{T_p} \sum_{h-\frac{T_p}{dt}+1}^h p_h$
  - $p_d = \max(p_{fix}, p_{max})$
  - $p_{max} = \max\limits_{h \in H}p_{T_p}[h]$

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- $\epsilon_{q_i}r_{q_i}$: Assignment Cost
- $z_p \phi_i(\eta_i - \nu_{b_i} \kappa_{b_i})$: Penalty Function
- $z_c r_{q_i} s_i$: Consumption Cost

** Constraints
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
  \begin{equation*}
      \label{seq:c0}
      u_j - d_i - (\sigma_{ij} - 1)T \ge 0
  \end{equation*}
  \begin{equation*}
      \label{seq:c1}
      q_j - q_i - 1 - (\psi_{ij} - 1)Q \ge 0
  \end{equation*}
  \begin{equation*}
      \label{seq:c2}
      \sigma_{ij} + \sigma_{ji} \le 1
  \end{equation*}
  \begin{equation*}
     \label{seq:c3}
      \psi_{ij} + \psi_{ji} \le 1
  \end{equation*}

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
  \begin{equation*}
      \label{seq:c4}
      \sigma_{ij} + \sigma_{ji} + \psi_{ij} + \psi_{ji} \ge 1
  \end{equation*}
  \begin{equation*}
      \label{seq:c5}
      s_i = d_i - u_i
  \end{equation*}
  \begin{equation*}
      \label{seq:c6}
       \eta_{\xi_i} = \eta_{i} + r_{q_i}s_i - \Delta_i
  \end{equation*}
  \begin{equation*}
      \label{seq:c7}
      \kappa_{\Xi_i} \geq \eta_{i} + r_{q_i}s_i
  \end{equation*}
  \begin{equation*}
      \label{seq:c8}
      a_i \leq u_i \leq d_i \le e_i \le \mathcal{T}
  \end{equation*}

** Results

| *Model*     | *Execution Time* [s] | *Iteration* [s] |
|-----------+--------------------+---------------|
| MILP      |               1900 |           N/A |
| Quick     |             1532.8 |           0.4 |
| Heuristic |               1916 |           0.5 |

*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- $T_0 = 90000$
- $\beta = 0.997$
*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- $|t| = 3797$
- $n_K = 500$

** Schedule
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:

#+latex: {\scriptsize
- Point 1
- Point 2
#+latex: }

\begin{figure}
\begin{subfigure}[t]{\textwidth}
\centering
    \includegraphics[width=0.75\textwidth]{img/sa-pap-paper-good/schedule-milp}
\end{subfigure}
\begin{subfigure}[t]{\textwidth}
\centering
    \includegraphics[width=0.75\textwidth]{img/sa-pap-paper-good/schedule-quinn}
\end{subfigure}
\end{figure}

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:


#+latex: {\scriptsize
- Point 3
- Point 4
#+latex: }

\begin{figure}
\begin{subfigure}[t]{\textwidth}
\centering
    \includegraphics[width=0.75\textwidth]{img/sa-pap-paper-good/schedule-sa-quick}
\end{subfigure}
\begin{subfigure}[t]{\textwidth}
\centering
    \includegraphics[width=0.75\textwidth]{img/sa-pap-paper-good/schedule-sa-heuristic}
\end{subfigure}
\end{figure}

** Charger Count :noexport:
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-good/charger-count-slow-milp-qin}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-good/charger-count-slow-sa}
\end{figure}

** Charger Count :noexport:
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-good/charger-count-fast-milp-qin}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-good/charger-count-fast-sa}
\end{figure}

** Power
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-good/power-milp-qin}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-good/power-sa}
\end{figure}
** Energy
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-good/energy}
\end{figure}

* The Simulated Annealing Approach With Non-Linear Battery Dynamics
** Introduction
- Higher fidelity in approximating charge at high SOC
- Implemented in SA for simplicity
** Non-Linear Battery Dynamics Model
- Show function
- Show plots
** Results
- Figures!

* Supplemental Slides
** Supplemental Material :noexport:
** Mixed Integer Linear Programming*

\begin{align*}
\text{max }        &J = \sum_j c_j x_j + \sum_k d_k y_k&         &               \\
\text{subject to } &\sum_j a_{ij} x_j + \sum_k g_{ik} y_k \le b_i&  &(i = 1,2,...,m)\\
                  &x_j \ge 0&                              &(j = 1,2,...,n)\\
                  &y_k \in \mathbb{Z^+}&                   &(k = 1,2,...,n)\\
\end{align*}

- $J$: Objective function
- $x_j \in \mathbb{R}$ and $y_k \in \mathbb{Z}^+$: Decision Variables
- $c_j, d_k, a_{ij}, g_{ik}, b_i \in \mathbb{R}$: Parameters


** SA Primitive Generators :noexport:
** New Visit*
#+include: alg/new-visit.org
** Slide Visit
#+include: alg/slide-visit.org
** New Charger
#+include: alg/new-charger.org
** Wait
#+include: alg/wait.org
** New Window
#+include: alg/new-window.org


** SA Wrapper Functions :noexport:
** Charge Schedule Generation*
#+include: alg/charge-schedule-generation.org
#+include: alg/tweak-schedule.org


** SA Old Results :noexport:
** Results - What Is In The Thesis*
| *Model*     | *Execution Time* [s] | *Iteration* [s] |
|-----------+--------------------+---------------|
| MILP      |               3600 |           N/A |
| Quick     |            2275.25 |          0.25 |
| Heuristic |             3640.4 |           0.4 |

*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- $T_0 = 99999$
- $\beta = 0.999$
*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:
- $|t| = 3797$
- $n_K = 500$

** Schedule- What Is In The Thesis
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/schedule-milp}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/schedule-quinn}
\end{figure}

** Schedule - What Is In The Thesis
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/schedule-sa-quick}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/schedule-sa-heuristic}
\end{figure}

** Charger Count - What Is In The Thesis
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/charger-count-slow-milp-qin}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/charger-count-slow-sa}
\end{figure}

** Charger Count - What Is In The Thesis
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/charger-count-fast-milp-qin}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/charger-count-fast-sa}
\end{figure}

** Power - What Is In The Thesis
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/power-milp-qin}
\end{figure}
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/power-sa}
\end{figure}
** Energy - What Is In The Thesis
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/sa-pap-paper-bad/energy}
\end{figure}

** What Happened?
** How To Resolve This Problem?
\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/score-convergence}
\end{figure}

- Reverse search and weight the visit indices
- Be more aggressive in exploiting the best solution

\begin{figure}[htpb]
\centering
    \includegraphics[width=0.6\textwidth]{img/score-diverge}
\end{figure}

- Candidate solutions diverge
- Hard time handling "difficult" routes

** Score Convergence Comparison
*** Left
:PROPERTIES:
:BEAMER_col: 0.5
:END:

#+begin_center
Before Fix
#+end_center

\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/score-diverge}
\end{figure}

*** Right
:PROPERTIES:
:BEAMER_col: 0.5
:END:

#+begin_center
After Fix
#+end_center

\begin{figure}[htpb]
\centering
    \includegraphics[width=\textwidth]{img/score-convergence}
\end{figure}

* Footnotes

[fn:3] https://www.mdpi.com/2077-1312/11/7/1280
[fn:2] PAP application only
[fn:1]  A visit describes when a bus arrives, assigned a charge queue, and then departs
